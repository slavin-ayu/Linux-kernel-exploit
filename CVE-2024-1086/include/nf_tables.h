#pragma once

#include <libmnl/libmnl.h>
#include <libnftnl/table.h>
#include <libnftnl/chain.h>
#include <libnftnl/rule.h>
#include <libnftnl/expr.h>

void add_payload(struct nftnl_rule *r, uint32_t base, uint32_t dreg, uint32_t offset, uint32_t len);
void add_cmp(struct nftnl_rule *r, uint32_t sreg, uint32_t op, const void *data, uint32_t data_len);
void add_set_verdict(struct nftnl_rule *r, uint32_t val);
struct nftnl_rule *alloc_rule(unsigned char family, const char *table, const char *chain, unsigned char proto);
struct nftnl_table *alloc_table(unsigned char family, const char *table_name);
struct nftnl_chain *alloc_chain(unsigned char family, const char *table, const char *chain, unsigned int hooknum);
void unconfigure_nftables();
void configure_nftables();
